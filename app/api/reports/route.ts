import { NextRequest, NextResponse } from 'next/server'; import { prisma } from '@/lib/prisma'; export async function GET(req: NextRequest) { const token = req.headers.get('x-admin-token'); if (!token || token !== process.env.ADMIN_SECRET) return NextResponse.json({error: 'Unauthorized'}, {status:401}); const reports = await prisma.report.findMany({ orderBy: { createdAt: 'desc' }, take: 50 }); return NextResponse.json({ reports }); } export async function DELETE(req: NextRequest) { const token = req.headers.get('x-admin-token'); if (!token || token !== process.env.ADMIN_SECRET) return NextResponse.json({error: 'Unauthorized'}, {status:401}); const { searchParams } = new URL(req.url); const id = searchParams.get('id'); await prisma.report.delete({ where: { id: id! } }); return NextResponse.json({ success: true }); }
